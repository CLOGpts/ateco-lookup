📁 Dati salvati in: excel_lookups_complete.json
PS C:\Users\speci\Desktop\Varie\Celerya_Cyber_Ateco>   python extract_excel_complete.py
🚀 ESTRAZIONE COMPLETA DATI EXCEL

📖 Estrazione stringhe condivise...
   Trovate 624 stringhe

📊 Analisi foglio 'Analisi As-IS'...

🔍 Estrazione tabelle di LOOKUP...
   📌 Tabella Eventi-Descrizioni (F1001:G1200)...
      Trovati 192 eventi con descrizioni
   📌 Tabella Controlli-Descrizioni (W1001:X1146)...
      Trovati 4 controlli con descrizioni

📂 Estrazione categorie e domini...
   Domini trovati: 1
   Categorie trovate: 3

🧮 Analisi formule principali...

📝 Ricerca regole di validazione...
   Trovato file relazioni del foglio

💾 Salvataggio dati estratti...
   ✅ Dati salvati in excel_data_complete.json

============================================================
📊 RIEPILOGO ESTRAZIONE COMPLETA
============================================================
✅ Eventi mappati: 192
✅ Controlli mappati: 4
✅ Domini trovati: 1
✅ Categorie trovate: 3
✅ Formule analizzate: 7

📋 ESEMPI DI DATI ESTRATTI:

🎯 Primi 5 Eventi con descrizioni:
   1. 601 - Furto di denaro, cassa o altro: Furto di denaro o beni da parte di un dipendente o collabora...
   2. 606 - Abuso di potere e / o attività non autorizzata (intenzionale): Superamento dei limiti legali della propria funzione, atto i...
   3. 604 - Frode mista / collusione: Frode sia interna che esterna (collusione). Frode commessa d...
   4. 608 - Eccesso di fiducia / Sfruttamento di debolezza (frode interna): Abuso di una persona o processo vulnerabile: abuso fraudolen...
   5. 609 - Distruzione dannosa di beni / Attacco terroristico: Distruzione dannosa di beni (fuoco, danneggiamento intenzion...      

🛡️ Primi 5 Controlli con descrizioni:
   1. ++: Adeguato
...
   2. +: Sostanzialmente adeguato
...
   3. -: Parzialmente Adeguato
...
   4. --: Non adeguato / assente
...

🏢 Domini: 01 - Audit/Control...

📁 Categorie: External_fraud_Frodi_esterne, Internal_Fraud_Frodi_interne, Clients_product_Clienti...

🧮 Formula VLOOKUP eventi:
   IFERROR(VLOOKUP(F5,$F$1001:$G$1200,2,0),"")

🧮 Formula conversione rating:
   IF(AC5="G",4,IF(AC5="Y",3,IF(AC5="O",2,IF(AC5="R",1,"N/A"))))...

✅ ESTRAZIONE COMPLETATA!
📁 I dati sono stati salvati in 'excel_data_complete.json'

⚡ Ora possiamo replicare ESATTAMENTE le logiche Excel in Python!
PS C:\Users\speci\Desktop\Varie\Celerya_Cyber_Ateco>   python api_complete_excel.py
✅ Dati lookup Excel caricati!
✅ Dati eventi Excel caricati!

================================================================================
🚀 RISK ASSESSMENT API - REPLICA ESATTA EXCEL
================================================================================

📊 DATI CARICATI DALL'EXCEL:
  ✅ Domini: 17
  ✅ Processi: 111
  ✅ Categorie: 10
  ✅ Eventi: 192
  ✅ Controlli: 4

📝 CAMPI TOTALI: 22 (Colonne B-AM)

📍 Server in ascolto su: http://localhost:8000
📊 Test API: http://localhost:8000/docs
================================================================================

INFO:     Started server process [7804]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
INFO:     127.0.0.1:58764 - "GET /events/list HTTP/1.1" 404 Not Found